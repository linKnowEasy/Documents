<!DOCTYPE HTML>

<!--
 ______________ 
< TUICOOL.COM >
 -------------- 
        \   ^__^
         \  (**)\__$__$__
            (__)\       )\/\
             U  ||------|
                ||     ||
-->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="authenticity_token" name="csrf-param" />
<meta content="48/qOzEXpDaDe8kYTHNyLHaW9P6gWVDtjnQ8K5u8EAY=" name="csrf-token" />
    <title>
            iOS 原生扫 QR 码的那些事 - 推酷
   </title>
    <meta name="description" content="iOS 原生扫 QR 码的那些事"/>
  <link rel="shortcut icon" href="http://static0.tuicool.com/favicon.ico" type="image/x-icon" />
  <link href="http://static0.tuicool.com/images/icon114.png" rel="Bookmark" />
  <link rel="apple-touch-icon" sizes="57x57" href="http://static1.tuicool.com/images/icon57.png" /> 
  <link rel="apple-touch-icon" sizes="72x72" href="http://static2.tuicool.com/images/icon72.png" />  
  <link rel="apple-touch-icon" sizes="114x114" href="http://static0.tuicool.com/images/icon114.png" />    
  <link rel="apple-touch-icon" sizes="144x144" href="http://static1.tuicool.com/images/icon144.png"/>  
  <link href="/assets/application-227c33f42868e66d614704e884980325.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="http://static0.tuicool.com/assets/font-awesome.min.css" rel="stylesheet">
  <script src="/assets/application-8629c2105229c8b87cdabc146cce0272.js" type="text/javascript"></script>

  <!--[if IE 7]>
  <link rel="stylesheet" href="http://assets.tuicool.com/assets/font-awesome-ie7.min.css">
  <![endif]--> 
    <script type="text/javascript" src="http://static2.tuicool.com/assets/tip.js?t=3"></script>
  
  <script type="text/javascript" src="http://static1.tuicool.com/assets/spin.min.js"></script>
<link rel="stylesheet" href="http://static0.tuicool.com/assets/github.css">
<script type="text/javascript" src="http://cbjs.baidu.com/js/m.js"></script>

</head>
<body>
  
  <div id="header" class="navbar-fixed-top">
    <div class="container">
      <div class="navbar">
        <div class="navbar-inner">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> 
            <span class="icon-bar"></span> 
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> 
          </a>
          <a href="http://www.tuicool.com/" class="brand">推酷</a>        
        <nav class="nav-collapse collapse">
            <ul class="nav navbar primary-nav">                            
              <li class="active">
                <a href="http://www.tuicool.com/ah">
                  文章
                </a>
              </li>              
              <li class="">
                <a href="http://www.tuicool.com/sites/hot">
                  站点
                </a>
              </li>
              <li class="">
                <a href="http://www.tuicool.com/topics">
                  主题
                </a>
              </li>
              <li class="">
                <a href="http://course.tuicool.com/">
                  公开课
                </a>
              </li>
              <li class="">
                <a href="http://huodong.tuicool.com/">
                  活动
                </a>
              </li>
              <li class="">
                <a href="http://www.tuicool.com/mobile">
                  客户端
                    <sup style="font-size:0.8em;color: #16A085;">荐</sup>
                </a>
              </li>
              <li class="dropdown  ">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">周刊 <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="http://www.tuicool.com/mags">编程狂人</a></li>
                  <li><a href="http://www.tuicool.com/mags/design">设计匠艺</a></li> 
                  <li><a href="http://www.tuicool.com/mags/startup">创业周刊</a></li> 
                  <li><a href="http://www.tuicool.com/mags/tech">科技周刊</a></li>      
                  <li><a href="http://www.tuicool.com/mags/guru">Guru Weekly</a></li> 
                  <li><a href="http://www.tuicool.com/articles/weekly">一周拾遗</a></li>                  
                </ul>
              </li>
              
              </ul>
            <form class="navbar-search pull-left" action="http://www.tuicool.com/search">
              <input type="text" class="search-query span2" name="kw" placeholder="搜索">
            </form>
            <ul class="nav pull-right">
                <li><a href="http://www.tuicool.com/login">登录</a></li>
            </ul>
          </nav>
        </div>
      </div>
  </div>   
</div>
  <div id ="flash_container" class="noPrint">    
  </div>
  
  <div class="container-fluid">  
      
<div class="row-fluid article_row_fluid">
    <div class="span8 contant article_detail_bg">
        <h1>iOS 原生扫 QR 码的那些事</h1>
        <div class="article_meta">
            <div style="margin-bottom: 5px;">
            <span class="timestamp">时间&nbsp;2015-10-29 12:11:12
            </span>
            <span class="from">
                <i class="icon-globe"></i>
                    <a class="cut cut28 from" href="/sites/U3MJfq" target="_blank">小明的 iOS 开发 blog
                    </a>
            </span>
            </div>
            <div class="source">
                <i style="float:left;">原文</i>&nbsp; 
                <a class="cut cut70" href="http://c0ming.me/qr-code-scan/?utm_source=tuicool&amp;utm_medium=referral" style="display:inline-block;">http://c0ming.me/qr-code-scan/</a>
            </div>
            <div>
                <span>主题</span>
                <a href="/topics/10250001" target='_blank' >
                    <span class="new-label">iOS</span>
                </a>
            </div>
        </div>
        <div class="article_body" id="nei">
            <div> 
 <p> 很多应用都有扫描二维码的功能，在开发这些功能时大家都可能接触过 <a href="https://github.com/zxing/zxing" rel="nofollow,noindex">ZXing</a> 或 <a href="https://github.com/ZBar/ZBar" rel="nofollow,noindex">ZBar</a> 这类第三方扫码库，但从 iOS 7 开始系统原生 API 就支持通过扫描获取二维码的功能。今天就来说说原生扫码的那些事。 </p> 
 <h3>0、相机权限</h3> 
 <p>也是从 iOS 7 开始，应用要使用相机功能首先要获得用户的授权，所以要先判断授权情况。 </p> 
 <ul> 
  <li>判断授权情况方法：</li> 
 </ul> 
 <pre class="prettyprint"><code>AVAuthorizationStatus authorizationStatus = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];  
</code></pre> 
 <ul> 
  <li> <strong>AVAuthorizationStatus</strong> enum 值有： </li> 
 </ul> 
 <pre class="prettyprint"><code>typedef NS_ENUM(NSInteger, AVAuthorizationStatus) {  
	AVAuthorizationStatusNotDetermined = 0,
	AVAuthorizationStatusRestricted, // 受限，有可能开启了访问限制
	AVAuthorizationStatusDenied,
	AVAuthorizationStatusAuthorized
} NS_AVAILABLE_IOS(7_0);
</code>
</pre> 
 <ul> 
  <li>请求授权方法：</li> 
 </ul> 
 <pre class="prettyprint"><code>[AVCaptureDevice requestAccessForMediaType:AVMediaTypeVideo completionHandler: ^(BOOL granted) {
    if (granted) { 
        [self startCapture]; // 获得授权
    } else {    
        NSLog(@&quot;%@&quot;, @&quot;访问受限&quot;);
    }
}];
</code></pre> 
 <ul> 
  <li>完整授权处理逻辑:</li> 
 </ul> 
 <pre class="prettyprint"><code>AVAuthorizationStatus authorizationStatus = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];  
switch (authorizationStatus) {  
	case AVAuthorizationStatusNotDetermined: {
		[AVCaptureDevice requestAccessForMediaType:AVMediaTypeVideo completionHandler: ^(BOOL granted) {
			if (granted) {
				[self startCapture];
			} else {
				NSLog(@&quot;%@&quot;, @&quot;访问受限&quot;);
			}
		}];
		break;
	}
	case AVAuthorizationStatusAuthorized: {
		[self startCapture];
		break;
	}
	case AVAuthorizationStatusRestricted:
	case AVAuthorizationStatusDenied: {
		NSLog(@&quot;%@&quot;, @&quot;访问受限&quot;);
		break;
	}
	default: {
		break;
	}
}
</code>
</pre> 
 <h3>1、扫码</h3> 
 <ul> 
  <li>AVCaptureSession</li> 
 </ul> 
 <p>扫码是一个从摄像头（input）到 解析出字符串（output） 的过程，用AVCaptureSession 来协调。其中是通过 AVCaptureConnection 来连接各个 input 和 output，还可以用它来控制 input 和 output 的 数据流向。它们的关系如下图：</p> 
 <p> <img src="http://img0.tuicool.com/7J7r2qY.png!web" class="alignCenter" /> </p> 
 <ul> 
  <li>扫码的代码很简单，如下：</li> 
 </ul> 
 <pre class="prettyprint"><code>AVCaptureSession *session = [[AVCaptureSession alloc] init];  
AVCaptureDevice *device = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo];  
NSError *error;  
AVCaptureDeviceInput *deviceInput = [AVCaptureDeviceInput deviceInputWithDevice:device error:&amp;error];  
if (deviceInput) {  
	[session addInput:deviceInput];
	AVCaptureMetadataOutput *metadataOutput = [[AVCaptureMetadataOutput alloc] init];
	[metadataOutput setMetadataObjectsDelegate:self queue:dispatch_get_main_queue()];
	[session addOutput:metadataOutput]; // 这行代码要在设置 metadataObjectTypes 前
	metadataOutput.metadataObjectTypes = @[AVMetadataObjectTypeQRCode];
	AVCaptureVideoPreviewLayer *previewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
	previewLayer.videoGravity = AVLayerVideoGravityResizeAspectFill;
	previewLayer.frame = self.view.frame;
	[self.view.layer insertSublayer:previewLayer atIndex:0];
	[session startRunning];
} else {
	NSLog(@&quot;%@&quot;, error);
}
</code>
</pre> 
 <ul> 
  <li>扫码结果从委托方法返回：</li> 
 </ul> 
 <pre class="prettyprint"><code>- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputMetadataObjects:(NSArray *)metadataObjects fromConnection:(AVCaptureConnection *)connection {
	AVMetadataMachineReadableCodeObject *metadataObject = metadataObjects.firstObject;
	if ([metadataObject.type isEqualToString:AVMetadataObjectTypeQRCode] &amp;&amp; !self.isQRCodeCaptured) { // 成功后系统不会停止扫描，可以用一个变量来控制。
		self.isQRCodeCaptured = YES;
		NSLog(@&quot;%@&quot;, metadataObject.stringValue);
	}
}
</code>
</pre> 
 <h3>2、从图片文件解析（iOS 8 起）</h3> 
 <p>从 iOS 8 开始你也可以从图片文件解析出二维码，用到 Core Image 的 CIDetector。</p> 
 <p>代码也很简单：</p> 
 <pre class="prettyprint"><code>CIDetector *detector = [CIDetector detectorOfType:CIDetectorTypeQRCode context:nil options:@{ CIDetectorAccuracy:CIDetectorAccuracyHigh }];  
CIImage *image = [[CIImage alloc] initWithImage:[UIImage imageNamed:@&quot;foobar.png&quot;]];  
NSArray *features = [detector featuresInImage:image];  
for (CIQRCodeFeature *feature in features) {  
    NSLog(@&quot;%@&quot;, feature.messageString);
}
</code></pre> 
 <p> <img src="http://img0.tuicool.com/3eaU7jJ.png!web" class="alignCenter" /> 
  <center>
   (foobar.png)
  </center> </p> 
 <h3>3、生成二维码图片</h3> 
 <p> 生成二维码用到了 <a href="https://developer.apple.com/library/mac/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIQRCodeGenerator" rel="nofollow,noindex">CIQRCodeGenerator</a> 这种 CIFilter。它有两个字段可以设置，inputMessage 和 inputCorrectionLevel。inputMessage 是一个 NSData 对象，可以是字符串也可以是一个 URL。inputCorrectionLevel 是一个单字母（@&quot;L&quot;, @&quot;M&quot;, @&quot;Q&quot;, @&quot;H&quot; 中的一个），表示不同级别的容错率，默认为 @&quot;M&quot;。 </p> 
 <div> 
  <p>QR码有容错能力，QR码图形如果有破损，仍然可以被机器读取内容，最高可以到7%~30%面积破损仍可被读取。所以QR码可以被广泛使用在运输外箱上。</p> 
  <p>相对而言，容错率愈高，QR码图形面积愈大。所以一般折衷使用15%容错能力。</p> 
  <div> 
   <p>错误修正容量 L水平 7%的字码可被修正</p> 
   <p>M水平 15%的字码可被修正</p> 
   <p>Q水平 25%的字码可被修正</p> 
   <p>H水平 30%的字码可被修正</p> 
  </div> 
 </div> 
 <p>所以很多二维码的中间都有头像之类的图片但仍然可以识别出来就是这个原因。</p> 
 <p>代码如下，应该注意的是：</p> 
 <ul> 
  <li>1）官方建议使用 NSISOLatin1StringEncoding 来编码，但经测试这种编码对中文或表情无法生成，改用 NSUTF8StringEncoding 就可以了。</li> 
  <li>2）生成的图片尺寸(outputImage.extent.size)会比较小，需要对它进行缩放。</li> 
  <li>3）生成的 CIImage 需要先转成 CGImage 才可以保存，因为 UIImagePNGRepresentation 接受的 UIImage 要有 CGImage，如果没有或者位图格式不对都会返回 nil。</li> 
 </ul> 
 <pre class="prettyprint"><code>// return image as PNG. May return nil if image has no CGImageRef or invalid bitmap format
NSData * UIImagePNGRepresentation(UIImage *image);  
</code></pre> 
 <pre class="prettyprint"><code>NSString *urlString = @&quot;http://weibo.com/u/2255024877&quot;;  
NSData *data = [urlString dataUsingEncoding:NSISOLatin1StringEncoding]; // NSISOLatin1StringEncoding 编码

CIFilter *filter = [CIFilter filterWithName:@&quot;CIQRCodeGenerator&quot;];  
[filter setValue:data forKey:@&quot;inputMessage&quot;];

CIImage *outputImage = filter.outputImage;  
NSLog(@&quot;%@&quot;, NSStringFromCGSize(outputImage.extent.size));

CGAffineTransform transform = CGAffineTransformMakeScale(scale, scale); // scale 为放大倍数  
CIImage *transformImage = [outputImage imageByApplyingTransform:transform];

// 保存
CIContext *context = [CIContext contextWithOptions:nil];  
CGImageRef imageRef = [context createCGImage:transformImage fromRect:transformImage.extent];

UIImage *qrCodeImage = [UIImage imageWithCGImage:imageRef];  
[UIImagePNGRepresentation(qrCodeImage) writeToFile:path atomically:NO];

CGImageRelease(imageRef);  
</code></pre> 
 <p> <img src="http://img2.tuicool.com/jAFbYjU.png!web" class="alignCenter" /> 
  <center>
   (生成的二维码图片)
  </center> </p> 
 <h3>4、扫描框</h3> 
 <ul> 
  <li>rectOfInterest</li> 
 </ul> 
 <p>扫码时 previewLayer 的扫描范围是整个可视范围的，但有些需求可能需要指定扫描的区域，虽然我觉得这样很没有必要，因为整个屏幕都可以扫又何必指定到某个框呢？但如果真的需要这么做可以设定 metadataOutput 的 rectOfInterest。</p> 
 <p>需要注意的是：</p> 
 <ul> 
  <li> 1） <a href="https://developer.apple.com/library/prerelease/ios/documentation/AVFoundation/Reference/AVCaptureMetadataOutput/index.html#//apple_ref/occ/instp/AVCaptureMetadataOutput/rectOfInterest" rel="nofollow,noindex">rectOfInterest</a> 的值比较特别，需要进行转化。它的默认值是 (0.0, 0.0, 1.0, 1.0)。 </li> 
 </ul> 
 <pre class="prettyprint"><code>metadataOutput.rectOfInterest = [previewLayer metadataOutputRectOfInterestForRect:CGRectMake(80, 80, 160, 160)]; // 假设扫码框的 Rect 是 (80, 80, 160, 160)  
</code></pre> 
 <ul> 
  <li> 2) rectOfInterest 不可以直接在设置 metadataOutput 时接着设置，而需要在这个 <a href="https://developer.apple.com/library/prerelease/ios/documentation/AVFoundation/Reference/AVCaptureInputPort_Class/index.html#//apple_ref/c/data/AVCaptureInputPortFormatDescriptionDidChangeNotification" rel="nofollow,noindex">AVCaptureInputPortFormatDescriptionDidChangeNotification</a> 通知里设置，否则 metadataOutputRectOfInterestForRect: 转换方法会返回 (0, 0, 0, 0)。 </li> 
 </ul> 
 <pre class="prettyprint"><code>[[NSNotificationCenter defaultCenter] addObserverForName:AVCaptureInputPortFormatDescriptionDidChangeNotification
                                                        object:nil
                                                         queue:[NSOperationQueue currentQueue]
                                                    usingBlock: ^(NSNotification *_Nonnull note) {
      metadataOutput.rectOfInterest = [previewLayer metadataOutputRectOfInterestForRect:CGRectMake(80, 80, 160, 160)];
}];
</code></pre> 
 <ul> 
  <li>扫码框的外观</li> 
 </ul> 
 <p> 扫码框四周一般都是半透明的黑色，而它里面是没有颜色的。 <img src="http://img1.tuicool.com/um6z2e.jpg!web" class="alignCenter" /> 
  <center>
   (扫码框)
  </center> </p> 
 <p>你可以在扫码框四周各添加视图，但更简单的方法是自定义一个视图，在 drawRect: 画扫码框的 path。代码如下：</p> 
 <pre class="prettyprint"><code>CGContextRef ctx = UIGraphicsGetCurrentContext();

CGFloat width = CGRectGetWidth([UIScreen mainScreen].bounds);  
[[[UIColor blackColor] colorWithAlphaComponent:0.5] setFill];

CGMutablePathRef screenPath = CGPathCreateMutable();  
CGPathAddRect(screenPath, NULL, self.bounds);

CGMutablePathRef scanPath = CGPathCreateMutable();  
CGPathAddRect(scanPath, NULL, CGRectMake(80, 80, 160, 160);

CGMutablePathRef path = CGPathCreateMutable();  
CGPathAddPath(path, NULL, screenPath);  
CGPathAddPath(path, NULL, scanPath);

CGContextAddPath(ctx, path);  
CGContextDrawPath(ctx, kCGPathEOFill); // kCGPathEOFill 方式

CGPathRelease(screenPath);  
CGPathRelease(scanPath);  
CGPathRelease(path);  
</code></pre> 
 <p>Demo：</p> 
 <p> <a href="https://github.com/c0ming/QRCodeDemo" rel="nofollow,noindex">QRCodeDemo</a> </p> 
 <p>总结：</p> 
 <p>从 iOS 7 开始系统就有很好的原生 API 来开发二维码相关的功能，它们不但识别速度快，而且还可以免除集成第三方扫码库的烦恼，不过如果需要用原生 API 来从图片获取二维码就要从 iOS 8 开始。</p> 
 <p>参考：</p> 
 <div> 
  <p> 1、 <a href="https://zh.wikipedia.org/wiki/QR%E7%A2%BC" rel="nofollow,noindex">QR码 via wikipedia</a> </p> 
  <p> 2、 <a href="https://developer.apple.com/library/ios/documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html#//apple_ref/doc/uid/TP40010188-CH5-SW2" rel="nofollow,noindex">AVFoundation Programming Guide</a> </p> 
  <p> 3、 <a href="https://developer.apple.com/library/prerelease/mac/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html" rel="nofollow,noindex">Core Image Filter Reference</a> </p> 
  <p> 4、 <a href="https://developer.apple.com/library/ios/documentation/GraphicsImaging/Conceptual/CoreImaging/ci_tasks/ci_tasks.html" rel="nofollow,noindex">Core Image Programming Guide</a> </p> 
  <p> 5、 <a href="http://stackoverflow.com/questions/32401364/how-do-i-use-the-metadataoutputrectofinterestforrect-method-and-rectofinterest-p" rel="nofollow,noindex">rectOfInterest via stackoverflow</a> </p> 
 </div> 
</div>
        </div>
        <div class="article_social">
         <div class="article_like">
    <div class="circle circle-like" id="my_zan" data_id="ie2aAjv">
    </div>
</div>
        <div id="share_weixin_image">
            <img width="100px" height="100px" src="http://s.jiathis.com/qrcode.php?url=http://www.tuicool.com/articles/ie2aAjv?via=wechat_qr">
        </div>
<div class="article_share_fav">
    <div class="share" id="ckepop">
        <span>分享</span>
        <button class="share_weibo" id="share_weibo_id"  title="分享到新浪微博"></button>
        <button class="share_qq" id="share_qq_id"  title="分享到QQ空间"></button>
        <button class="share_weixin" id="share_weixin_id"></button>
    </div>
    <div class="fav_correct">
        <button id="my_fav" data_id="ie2aAjv">
            <i class="icon icon-star-empty"></i> <span id="fav_tip">收藏</span>
        </button>
        <button id="article-correct" data_id="ie2aAjv">
            <i class="icon icon-warning-sign"></i>
            <span>纠错</span>
        </button>
    </div>
</div>
<script type="text/javascript">
$("#share_weibo_id").click( function() {
   window.open("http://share.baidu.com/s?type=text&searchPic=0&sign=on&to=tsina&url=http://www.tuicool.com/articles/ie2aAjv&title=iOS+%E5%8E%9F%E7%94%9F%E6%89%AB+QR+%E7%A0%81%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B++%28%E5%88%86%E4%BA%AB%E8%87%AA+%40%E6%8E%A8%E9%85%B7%E7%BD%91%29&key=3113829255");
});
$("#share_qq_id").click( function() {
   window.open("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://www.tuicool.com/articles/ie2aAjv&title=iOS+%E5%8E%9F%E7%94%9F%E6%89%AB+QR+%E7%A0%81%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B&desc=&summary=&site=");
});
$("#share_weixin_id").click( function() {
  $("#share_weixin_image").toggle();
});
</script>


            <div class="bottom_ad huodong-detail-ad-banner clearfix">
            <script type="text/javascript">BAIDU_CLB_fillSlot("1161130");</script>
            </div>
        </div>
        <div id="site_articles" style="clear:both;">
              <div class="article-part-title">
                <span>推荐文章</span>
              </div>
          <ul class="side_article_list">
                <li class="side_article_list_item">
                    1.<a href="/articles/mIbyAnJ" target="_blank" title="iOS开发笔记10:圆点缩放动画、强制更新、远程推送加语音提醒及UIView截屏">
                    iOS开发笔记10:圆点缩放动画、强制更新、远程推送加语音提醒及UIVie..
                    </a>
                </li>
                <li class="side_article_list_item">
                    2.<a href="/articles/me6JVf7" target="_blank" title="iOS闭包循环引用精讲">
                    iOS闭包循环引用精讲
                    </a>
                </li>
                <li class="side_article_list_item">
                    3.<a href="/articles/NBFfQb" target="_blank" title="iOS 动画绘制线条颜色渐变的折线图">
                    iOS 动画绘制线条颜色渐变的折线图
                    </a>
                </li>
                <li class="side_article_list_item">
                    4.<a href="/articles/QBVRB3z" target="_blank" title="源码推荐(02.24)：购物车CartDemo，滑动视图控制器">
                    源码推荐(02.24)：购物车CartDemo，滑动视图控制器
                    </a>
                </li>
                <li class="side_article_list_item">
                    5.<a href="/articles/zauEBvZ" target="_blank" title="WebKit, Safari和SafariiewController">
                    WebKit, Safari和SafariiewController
                    </a>
                </li>
                <li class="side_article_list_item">
                    6.<a href="/articles/RfqaIzy" target="_blank" title="iOS下的实际网络连接状态检测">
                    iOS下的实际网络连接状态检测
                    </a>
                </li>
          </ul>
        </div>
        <div id="kan_articles"></div>
        <div id="article_weibo" style="display:none;">
            <div class='article-part-title'>
                <span>相关微博</span>
                <sub>
                    <a href="/articles/weibo_list/ie2aAjv" target="_blank">(<i id="weibo_num"></i>)</a> 
               </sub>
            </div>
            <div class="related-weibo-list"></div>
        </div>
        <div class="comments">
    <div class="comments-area">
    <div class="comments-header">
        <h5>我来评几句</h5>
        <div class="alert comment-alert alert-error" style="display:none;">
            错误
        </div>
            <textarea cols="60" rows="5" id="comment-body" placeholder="请输入评论内容..." style="resize: none;"></textarea>
            <span class="btn btn-medium btn-submit"  id="comment-submit">登录后评论</span>
        <p style="margin-top: 5px;margin-left:10px;">
            已发表评论数(<span class="comment_cnt"></span>)
        </p>
    </div>
    <div class="comments-list">
        <div class="empty-cmts alert alert-success" style="display:none;">
            没有更多评论了^^
        </div>
    </div>
    <div class="more-comments" style="display:none;">
        <a href="">更多评论</a>
    </div>
    <div class="load-fail" style="display:none;">
        评论加载失败，<a href="javascript:reload_comments('ie2aAjv',1,0,-1);">重新加载</a>
    </div>
    </div>
</div>

    </div>
        <div class="span4 article_right_side">
            <div class="right_top">
    <div class="article_related_site article_detail_bg">
    <h4 class="article-part-title">相关站点</h4>
    <div class="article_related_site_body clearfix">
        <div class="logo">
            <img src="http://stimg3.tuicool.com/U3MJfq.png"/>
        </div>
        <div class="name">
            <div>
                <a href="/sites/U3MJfq" target="_blank"> 小明的 iOS 开发 blog</a>
            </div>
            <div>
                    <input type="button" class="btn btn-success right_site_follow" value="+&nbsp;订阅" id="my_follow" data_id="U3MJfq"/>
            </div>
        </div>
    </div>
</div>

<div class="right-ad">
      <a href="http://home.leangoo.com?f=tc" target="_blank"><img src="http://static0.tuicool.com/images/ad/leangoo300.jpg"/></a>

</div>
<div class="right-ad" style="margin-top: 8px">
      <a href="http://www.jiankongbao.com/?utm_source=web&utm_medium=banner&utm_campaign=tuicool" target="_blank"><img src="http://static2.tuicool.com/images/ad/yunzhihui300.jpg"/></a>

</div>
<div class="right-ad" style="margin-top: 8px">
      <a href="https://www.teambition.com/?utm_source=tuicool&utm_medium=banner01" target="_blank"><img src="http://static1.tuicool.com/images/ad/teambition300.jpg"/></a>

</div>
<div class="right-ad" style="margin-top: 8px">
      <a href="http://click.aliyun.com/m/3714/" target="_blank"><img src="http://static1.tuicool.com/images/ad/aliyun300.jpg"/></a>

</div>
<div id="right_site_articles" class="article_detail_bg">
    <div class="article-part-title">
        <span>热门文章</span>
    </div>
    <ul class="side_article_list">
        <li class="side_article_list_item">
            1.<a href="/articles/mIbyAnJ" target="_blank" title="iOS开发笔记10:圆点缩放动画、强制更新、远程推送加语音提醒及UIView截屏"> iOS开发笔记10:圆点缩放动画、强制更新、远程推送加语音提醒及UIView截屏 </a>
        </li>
        <li class="side_article_list_item">
            2.<a href="/articles/me6JVf7" target="_blank" title="iOS闭包循环引用精讲"> iOS闭包循环引用精讲 </a>
        </li>
        <li class="side_article_list_item">
            3.<a href="/articles/NBFfQb" target="_blank" title="iOS 动画绘制线条颜色渐变的折线图"> iOS 动画绘制线条颜色渐变的折线图 </a>
        </li>
        <li class="side_article_list_item">
            4.<a href="/articles/aiimYjZ" target="_blank" title="摆脱第三方库系列（一）-自己写一个侧拉菜单"> 摆脱第三方库系列（一）-自己写一个侧拉菜单 </a>
        </li>
        <li class="side_article_list_item">
            5.<a href="/articles/QBVRB3z" target="_blank" title="源码推荐(02.24)：购物车CartDemo，滑动视图控制器"> 源码推荐(02.24)：购物车CartDemo，滑动视图控制器 </a>
        </li>
        <li class="side_article_list_item">
            6.<a href="/articles/zauEBvZ" target="_blank" title="WebKit, Safari和SafariiewController"> WebKit, Safari和SafariiewController </a>
        </li>
    </ul>
</div>
</div>

<div class="operate_zone">
    <div class="container-body share-body">
        <div class="article-part-title">
            <span>分享本文</span>
        </div>
        <div class="share_zone">
    <div class="bdsharebuttonbox"> 
         <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
        <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a>
        <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_more" data-cmd="more"></a>
     </div>
    <script>
        window._bd_share_config = {
            "common" : {
                "bdSnsKey" : {
                    "tsina" : "3113829255",
                    "tqq" : "801536792"
                },
                "bdText" : "iOS 原生扫 QR 码的那些事 (分享自 @推酷网)",
                "bdMini" : "2",
                "bdMiniList" : false,
                "bdPic" : "http://aimg1.tuicool.com/AVFJVz.png",
                "bdStyle" : "1",
                "bdSize" : "24"
            },
            "share" : {}
        };
        with (document)
        0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</div>
    </div>
        <div class="frd_pos">
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-7054762349007490"
     data-ad-slot="5705695566"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
</div>
         </div>
</div>

<div class="read-later-alert">
</div>
<div>
   <a href="#add-article-to-kan" id="add-article-to-kan-btn" class="btn" data-toggle="modal" style="display:none;">添加到推刊</a>
   <!-- add_article to kan -->
<div id="add-article-to-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <span class="add-title">收藏到推刊</span>
    <a href="#new-kan" class="btn pull-right" data-toggle="modal">创建推刊</a>
    <i class="clearfix"></i>
  </div>
  <div class="modal-body">
    <ul id="add-kan-list">
    </ul>
  </div>
  <div class="modal-footer">
    <input type="hidden" value="ie2aAjv" class="article-id" /> 
    <button class="btn btn-primary pull-left add-to-btn">  收 藏  </button>
    <button class="btn" data-dismiss="modal" aria-hidden="true">取消</button>
  </div>
</div>
<div class="add-article-to-kan-alert">
  已收藏到推刊！
</div>

   <div id="new-kan" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-body">
    <input type="text" name="name" id="new-kan-name"  placeholder="推刊名(必填)" required data-validation-required-message="请填写推刊名" />
    <span class="new-ness-name">请填写推刊名</span>
    <br/>
    <textarea name="desc" id="desc" rows="6" placeholder="推刊描述"></textarea>
    <span class="new-ness-desc">描述不能大于100个字符!</span>
    <br/>
    权限设置：<input type="radio" name="type" value="1" checked="checked" /> 公开
    <input type="radio" name="type" value="0"> 仅自己可见
  </div>
  <div class="modal-footer">
    <button class="btn btn-primary pull-left create-kan-btn" disabled>创建</button>
    <button class="btn dismiss-new-kan" data-dismiss="modal" aria-hidden="true">取消</button>
  </div>
</div>


</div>
<div id="article-correct-modal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            &times;
        </button>
        <h3>文章纠错</h3>
    </div>
    <div class="modal-body">
        <input type="hidden" value="ie2aAjv" id="article-correct-source">
        <div>
            <label for="article-correct-email">
                邮箱地址
            </label>
            <input type="email" id="article-correct-email" class="input-large" />
        </div>
        <div>
            <label for="article-correct-select">
                错误类型
            </label>
            <select id="article-correct-select">
                <option value="正文不准确">正文不准确</option>
                <option value="排版有问题">排版有问题</option>
                <option value="没有分页内容">没有分页内容</option>
                <option value="视频无法显示">视频无法显示</option>
                <option value="图片无法显示">图片无法显示</option>
            </select>
        </div>
        <div>
            <label for="article-correct-other">
                补充信息
            </label>
            <textarea id="article-correct-other" class="span6"></textarea>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary pull-right huodong_correct_submit" id="article-correct-submit">
            &nbsp;&nbsp;提交&nbsp;&nbsp;
        </button>
    </div>
</div>

<style type="text/css">
    .btn-large {
        padding: 0;
    }
    .load-fail {
        display: none;
    }
</style>
<script src="http://static1.tuicool.com//assets/highlight.pack.js"></script>
<script type="text/javascript">
    $('table').each(function(i) {
        var size = $(this).children().size();
        if (size > 1) {
            $(this).attr('class',"table table-bordered");
        } else if (size == 1) {
            var e11 = $(this).children(":first");
            var e1 = e11[0];
            var name = e1.nodeName.toLowerCase();
            if ("tbody" == name) {
                if (e1.children.length > 1) {
                    $(this).attr('class',"table table-bordered");
                } else if (e1.children.length == 1){
                    var e12 = e1.children[0];
                    var name2 = e12.nodeName.toLowerCase();
                    if ("tr" == name2) {
                       if (e12.children.length > 1) {
                         $(this).attr('class',"table table-bordered");
                       }
                    }
                }
            }
        }
    });
            related_kan("ie2aAjv");
        window.page = 0;
        window.last = 0;    
        window.first = true;
        resize_article_image('#nei', 550);
                load_comments("ie2aAjv",1,0,-1);
                window.uid = -1;
        open_add_article_to_kan("false");
        async_do_zan_article(); 
        $('pre').each(function(i, e) {
            hljs.highlightBlock(e, "<span class='indent'>  </span>", false)
        });
       
          
       handle_follow_site("#my_follow","已订阅","+ 订阅");
</script>


  </div>

    <div class="footer">
    <div class="footer-inner">
    <dl class="about-link site-link">
        <dt>
            网站相关
        </dt>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/about">关于我们</a>
        </dd>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/mobile">移动应用</a>
        </dd>
        <dd>
            <a target="_blank" href="http://www.tuicool.com/bbs/go/issues">建议反馈</a>
        </dd>
    </dl>
    <dl class="site-link follow-link">
        <dt>
            关注我们
        </dt>
        <dd>
            <a target="_blank" href="http://e.weibo.com/tuicool2012"><img src="http://static1.tuicool.com/images/weibo-32.png">推酷网</a>
        </dd>
        <dd><img src="http://static1.tuicool.com/images/weixin-32.png">tuicool2012
        </dd>
    </dl>
    <dl class="site-link links">
        <dt>
            友情链接
        </dt>
        <dd>
                <a href="http://www.woshipm.com/" title="人人都是产品经理" target="_blank">人人都是产品经理</a>
                <a href="http://www.moobuu.com/" title="魔部网" target="_blank">魔部网</a>
                <a href="http://www.pm265.com/" title="PM256" target="_blank">PM256</a>
                <a href="http://www.pintu360.com/" title="品途网" target="_blank">品途网</a>
                <a href="http://www.yidonghua.com/" title="移动信息化" target="_blank">移动信息化</a>
                <a href="http://www.snsiu.com/" title="行晓网" target="_blank">行晓网</a>
                <a href="http://code4app.com/" title="Code4App" target="_blank">Code4App</a>
                <a href="http://www.taskcity.com/" title="智城外包网" target="_blank">智城外包网</a>
                <a href="http://blog.lamper.cn/" title="LAMP人" target="_blank">LAMP人</a>
                <a href="http://www.apkway.com/forum.php" title="安卓航班网" target="_blank">安卓航班网</a>
                <a href="http://www.huxiu.com/" title="虎嗅" target="_blank">虎嗅</a>
                <a href="http://www.ycpai.com/" title="缘创派" target="_blank">缘创派</a>
                <a href="http://www.iterduo.com/" title="IT耳朵" target="_blank">IT耳朵</a>
                <a href="http://www.iresearch.cn/" title="艾瑞网" target="_blank">艾瑞网</a>
                <a href="http://mediaworks.caixin.com/" title="创媒工场" target="_blank">创媒工场</a>
                <a href="http://www.leiphone.com/" title="雷锋网" target="_blank">雷锋网</a>
                <a href="http://www.managershare.com/" title="经理人分享" target="_blank">经理人分享</a>
                <a href="http://www.shichangbu.com/" title="市场部网" target="_blank">市场部网</a>
                <a href="http://www.ikanchai.com/" title="砍柴网" target="_blank">砍柴网</a>
                <a href="http://www.cocoachina.com/" title="CocoaChina" target="_blank">CocoaChina</a>
                <a href="http://www.ibeifeng.com/" title="北风网" target="_blank">北风网</a>
                <a href="http://www.jiankongbao.com/" title="云智慧" target="_blank">云智慧</a>
                <a href="http://www.wyzc.com" title="我赢职场" target="_blank">我赢职场</a>
                <a href="http://www.thebigdata.cn/" title="大数据时代" target="_blank">大数据时代</a>
                <a href="http://www.qidic.com/" title="奇笛网" target="_blank">奇笛网</a>
                <a href="http://www.cngulu.com/" title="咕噜网" target="_blank">咕噜网</a>
                <a href="http://www.linuxdiyf.com/" title="红联linux" target="_blank">红联linux</a>
                <a href="http://win10.ithome.com" title="Win10之家" target="_blank">Win10之家</a>
                <a href="http://www.niaogebiji.com/" title="鸟哥笔记" target="_blank">鸟哥笔记</a>
                <a href="http://www.play.cn" title="爱游戏" target="_blank">爱游戏</a>
                <a href="http://www.investide.cn/" title="投资潮" target="_blank">投资潮</a>
                <a href="http://www.31huiyi.com/" title="31会议网" target="_blank">31会议网</a>
                <a href="https://www.jpush.cn/" title="极光推送" target="_blank">极光推送</a>
                <a href="https://www.teambition.com/" title="Teambition" target="_blank">Teambition</a>
                <a href="http://cn.cocos2d-x.org/ " title="Cocos引擎中文官网" target="_blank">Cocos引擎中文官网</a>
                <a href="http://www.guigu.org/" title="硅谷网" target="_blank">硅谷网</a>
                <a href="https://home.leangoo.com/" title="leangoo" target="_blank">leangoo</a>
            <a href="/links">更多链接>></a>&nbsp;&nbsp;
        </dd>
    </dl>
    <div class="clear"></div>
    </div>
</div>

<div style="display:none;">
   <script src="http://s22.cnzz.com/stat.php?id=5541078&web_id=5541078&show=pic" language="JavaScript"></script>
</div>


</body>
</html>
